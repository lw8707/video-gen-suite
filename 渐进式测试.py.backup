#!/usr/bin/env python3
"""
æ¸è¿›å¼æµ‹è¯• - é€æ­¥æ·»åŠ åŠŸèƒ½ï¼Œé¿å…ä¸€æ¬¡æ€§å¡ä½
"""
import re
import time
import hashlib

class æ¸è¿›å®‰å…¨ç³»ç»Ÿ:
    def __init__(self):
        print("ğŸ”„ åˆå§‹åŒ–æ¸è¿›å®‰å…¨ç³»ç»Ÿ...")
    
    def é˜¶æ®µ1_åŸºç¡€è¿‡æ»¤(self):
        """é˜¶æ®µ1ï¼šåŸºç¡€è¾“å…¥è¿‡æ»¤"""
        print("\nğŸ¯ é˜¶æ®µ1: åŸºç¡€è¾“å…¥è¿‡æ»¤")
        
        def åŸºç¡€è¿‡æ»¤(æ–‡æœ¬):
            # ç®€å•æœ‰æ•ˆçš„è¿‡æ»¤è§„åˆ™
            è§„åˆ™ = [
                (r'[\x00-\x1f\x7f-\x9f]', ''),  # æ§åˆ¶å­—ç¬¦
                (r'\x1b\[[0-9;]*[mK]', ''),     # ANSIè½¬ä¹‰
                (r'\\[0-7]{3}', ''),            # å…«è¿›åˆ¶è½¬ä¹‰
            ]
            
            ç»“æœ = æ–‡æœ¬
            for æ¨¡å¼, æ›¿æ¢ in è§„åˆ™:
                ç»“æœ = re.sub(æ¨¡å¼, æ›¿æ¢, ç»“æœ)
            
            return ç»“æœ[:1000]  # é•¿åº¦é™åˆ¶
        
        # æµ‹è¯•
        æµ‹è¯•æ–‡æœ¬ = "æ­£å¸¸æ–‡æœ¬ \x1b[31mçº¢è‰²\000æ§åˆ¶"
        ç»“æœ = åŸºç¡€è¿‡æ»¤(æµ‹è¯•æ–‡æœ¬)
        print(f"âœ… åŸºç¡€è¿‡æ»¤æµ‹è¯•é€šè¿‡")
        print(f"   è¾“å…¥: {repr(æµ‹è¯•æ–‡æœ¬)}")
        print(f"   è¾“å‡º: {repr(ç»“æœ)}")
        
        return True
    
    def é˜¶æ®µ2_å“ˆå¸ŒæŒ‡çº¹(self):
        """é˜¶æ®µ2ï¼šå“ˆå¸ŒæŒ‡çº¹ç”Ÿæˆ"""
        print("\nğŸ¯ é˜¶æ®µ2: å“ˆå¸ŒæŒ‡çº¹")
        
        def ç”ŸæˆæŒ‡çº¹(æ–‡æœ¬):
            return hashlib.sha256(æ–‡æœ¬.encode('utf-8')).hexdigest()[:16]
        
        # æµ‹è¯•
        æµ‹è¯•æ–‡æœ¬ = "æµ‹è¯•æ–‡æœ¬"
        æŒ‡çº¹ = ç”ŸæˆæŒ‡çº¹(æµ‹è¯•æ–‡æœ¬)
        print(f"âœ… å“ˆå¸ŒæŒ‡çº¹æµ‹è¯•é€šè¿‡")
        print(f"   æ–‡æœ¬: {æµ‹è¯•æ–‡æœ¬}")
        print(f"   æŒ‡çº¹: {æŒ‡çº¹}")
        
        return True
    
    def é˜¶æ®µ3_æ€§èƒ½ç›‘æ§(self):
        """é˜¶æ®µ3ï¼šç®€å•æ€§èƒ½ç›‘æ§"""
        print("\nğŸ¯ é˜¶æ®µ3: æ€§èƒ½ç›‘æ§")
        
        class ç®€å•ç›‘æ§:
            def __init__(self):
                self.è®¡æ•° = 0
                self.æ€»æ—¶é—´ = 0
            
            def è®°å½•æ“ä½œ(self, æ“ä½œæ—¶é—´):
                self.è®¡æ•° += 1
                self.æ€»æ—¶é—´ += æ“ä½œæ—¶é—´
            
            def ç”ŸæˆæŠ¥å‘Š(self):
                return {
                    'æ“ä½œæ¬¡æ•°': self.è®¡æ•°,
                    'æ€»è€—æ—¶': self.æ€»æ—¶é—´,
                    'å¹³å‡è€—æ—¶': self.æ€»æ—¶é—´ / max(self.è®¡æ•°, 1)
                }
        
        # æµ‹è¯•
        ç›‘æ§ = ç®€å•ç›‘æ§()
        
        å¼€å§‹æ—¶é—´ = time.time()
        time.sleep(0.01)  # æ¨¡æ‹Ÿæ“ä½œ
        ç»“æŸæ—¶é—´ = time.time()
        
        ç›‘æ§.è®°å½•æ“ä½œ(ç»“æŸæ—¶é—´ - å¼€å§‹æ—¶é—´)
        æŠ¥å‘Š = ç›‘æ§.ç”ŸæˆæŠ¥å‘Š()
        
        print(f"âœ… æ€§èƒ½ç›‘æ§æµ‹è¯•é€šè¿‡")
        print(f"   æŠ¥å‘Š: {æŠ¥å‘Š}")
        
        return True

def ä¸»æµ‹è¯•():
    """ä¸»æµ‹è¯•å‡½æ•°"""
    ç³»ç»Ÿ = æ¸è¿›å®‰å…¨ç³»ç»Ÿ()
    
    é˜¶æ®µç»“æœ = []
    é˜¶æ®µç»“æœ.append(ç³»ç»Ÿ.é˜¶æ®µ1_åŸºç¡€è¿‡æ»¤())
    é˜¶æ®µç»“æœ.append(ç³»ç»Ÿ.é˜¶æ®µ2_å“ˆå¸ŒæŒ‡çº¹()) 
    é˜¶æ®µç»“æœ.append(ç³»ç»Ÿ.é˜¶æ®µ3_æ€§èƒ½ç›‘æ§())
    
    if all(é˜¶æ®µç»“æœ):
        print(f"\nğŸ‰ æ‰€æœ‰{len(é˜¶æ®µç»“æœ)}ä¸ªé˜¶æ®µæµ‹è¯•é€šè¿‡!")
        return True
    else:
        print(f"\nâŒ {é˜¶æ®µç»“æœ.count(False)}ä¸ªé˜¶æ®µæµ‹è¯•å¤±è´¥!")
        return False

if __name__ == "__main__":
    print("ğŸš€ å¯åŠ¨æ¸è¿›å¼å®‰å…¨æµ‹è¯•...")
    
    if ä¸»æµ‹è¯•():
        print("âœ… ç³»ç»Ÿå‡†å¤‡å°±ç»ª!")
    else:
        print("âŒ éœ€è¦è¿›ä¸€æ­¥è°ƒè¯•!")
